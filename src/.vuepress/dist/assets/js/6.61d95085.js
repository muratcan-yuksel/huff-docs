(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{428:function(e,t,a){e.exports=a.p+"assets/img/Seaport.fc2e3d29.png"},450:function(e,t,a){"use strict";a.r(t);var o=a(66),n=Object(o.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"hello-world"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#hello-world"}},[e._v("#")]),e._v(" Hello, world!")]),e._v(" "),o("p",[e._v("Note: This section is a continuation of "),o("RouterLink",{attrs:{to:"/tutorial/the-basics/"}},[e._v("'The Basics'")]),e._v(". If you have not read it yet we recommend you take a look at it before continuing!")],1),e._v(" "),o("hr"),e._v(" "),o("p",[e._v("Within "),o("RouterLink",{attrs:{to:"/tutorial/the-basics/"}},[e._v("'The Basics'")]),e._v(" we mentioned how "),o("code",[e._v('"Hello, world!"')]),e._v(" is quite an advanced concept for Huff. The reason being that we need to have an understanding of how strings are encoded in the EVM.")],1),e._v(" "),o("h2",{attrs:{id:"primer-abi-encoding"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#primer-abi-encoding"}},[e._v("#")]),e._v(" Primer: ABI Encoding")]),e._v(" "),o("p",[e._v("As strings are dynamic types it is not as simple as returning the UTF-8 values for "),o("code",[e._v('"Hello, world!"')]),e._v(" ("),o("code",[e._v("0x48656c6c6f2c20776f726c6421")]),e._v("). In the ABI standard, dynamic types are encoded in 3 parts, each which takes a full word (32 bytes) of memory.")]),e._v(" "),o("ol",[o("li",[e._v("The offset of the dynamic data. (pointer to the start of the dynamic data, uint256)")]),e._v(" "),o("li",[e._v("The length of the dynamic data. (uint256)")]),e._v(" "),o("li",[e._v("The values of the dynamic data. (dynamic length)")])]),e._v(" "),o("p",[e._v("Each part will look as follows for the string "),o("code",[e._v('"Hello, world!"')]),e._v(":")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v('Memory loc      Data\n0x00            0000000000000000000000000000000000000000000000000000000000000020 // The location of the "Hello, world!" data\n0x20            000000000000000000000000000000000000000000000000000000000000000d // The length of "Hello, world!" in bytes\n0x40            48656c6c6f2c20776f726c642100000000000000000000000000000000000000 // Value "Hello, world!"\n')])])]),o("h2",{attrs:{id:"implementation"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#implementation"}},[e._v("#")]),e._v(" Implementation")]),e._v(" "),o("p",[e._v("The following "),o("code",[e._v("MAIN")]),e._v(" macro steps through this encoding in a clear way.")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v('\n#define macro MAIN() = takes(0) returns(0) {\n    // store dynamic offset of 0x20 at 0x00\n    0x20                                     // [0x20]\n    0x00                                     // [0x00, 0x20]\n    mstore                                   // []\n\n    // store string length of 0x0d at 0x20\n    0x0d                                     // [0x0d]\n    0x20                                     // [0x20, 0x0d]\n    mstore                                   // []\n\n    // store bytes for "Hello, world!" at 0x40\n    __RIGHTPAD(0x48656c6c6f2c20776f726c6421) // ["Hello, world!"]\n    0x40                                     // [0x40, "Hello, world!"]\n    mstore                                   // []\n\n    // return full 96 byte value\n    0x60                                     // [0x60]\n    0x00                                     // [0x00, 0x60]\n    return                                   // []\n}\n\n')])])]),o("p",[e._v("Have a look how memory is set and what is returned interactively with "),o("a",{attrs:{href:"https://www.evm.codes/playground?unit=Wei&codeType=Mnemonic&code='v20~0z~0d~2zws32t48656c6c6f2c20776f726c6421yyyyyyu~4z~60~uwRETURN'~wvz0wMSTOREwyuuuw%5Cnvs1tu00t%200xsPUSH%01stuvwyz~_",target:"_blank",rel:"noopener noreferrer"}},[e._v("evm.codes playground"),o("OutboundLink")],1),e._v(" for this example.")]),e._v(" "),o("h2",{attrs:{id:"advanced-topic-the-seaport-method-of-returning-strings"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#advanced-topic-the-seaport-method-of-returning-strings"}},[e._v("#")]),e._v(" Advanced topic - The Seaport method of returning strings")]),e._v(" "),o("p",[e._v('Notice in the previous example that 3 adjacent words (32 bytes each) are being stored in memory. The 1st word is the offset and the 2nd word is the length. Both of these are left padded as all values are. The 3rd word is right padded because its bytes. Notice the length and the bytes are adjacent to each other in the memory schema. The length, "0d" is in memory location 0x3F and the first byte of "Hello, world!", 0x48, is stored at 0x40.')]),e._v(" "),o("p",[e._v("If we take the length ("),o("code",[e._v("0x0d")]),e._v(") and the bytes ("),o("code",[e._v("0x48656c6c6f2c20776f726c6421")]),e._v("), and concatenate them, we would get: "),o("code",[e._v("0x0d48656c6c6f2c20776f726c6421")]),e._v(" which becomes left padded value of:")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("0x000000000000000000000000000000000000000d48656c6c6f2c20776f726c6421\n")])])]),o("p",[e._v("Now, instead of starting the second word at "),o("code",[e._v("0x20")]),e._v(", if we offset that by 13 bytes (starting at "),o("code",[e._v("0x2d")]),e._v(" instead of "),o("code",[e._v("0x20")]),e._v(") then it lines up so that the "),o("code",[e._v("0d")]),e._v(" falls in the right most (lowest) bits of the second word (location 0x3F) and the remaining bytes start immediately in the first leftmost (highest) byte of the third word (location 0x40).")]),e._v(" "),o("p",[e._v("This is a common technique in Huff and was also made popular by "),o("a",{attrs:{href:"https://github.com/ProjectOpenSea/seaport/blob/fb1c3bf4c25a32ae90f776652a8b2b07d5df52cf/contracts/Seaport.sol#L95-L108",target:"_blank",rel:"noopener noreferrer"}},[e._v("Seaport's _name() function"),o("OutboundLink")],1),e._v(".")]),e._v(" "),o("p",[e._v('Here is a diagram illustrating the "Seaport" method using the string "TKN":')]),e._v(" "),o("p",[o("img",{attrs:{src:a(428),alt:'The "Seaport" method'}})])])}),[],!1,null,null,null);t.default=n.exports}}]);